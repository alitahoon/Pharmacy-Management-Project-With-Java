/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Forms;

import Entity.Drags;
import Entity.Store;
import java.text.SimpleDateFormat;
import java.util.Date;
import pharmacysystem.myprotools;

/**
 *
 * @author Ali
 */
public class frmDrags extends javax.swing.JFrame {

    /**
     * Creates new form frmDrags
     */
    public frmDrags() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        btnGroup = new javax.swing.ButtonGroup();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        calenderExDate = new com.toedter.calendar.JDateChooser();
        comStrCode = new systemControlsComponent.JCOMPBOX();
        btnAdd = new systemControlsComponent.JBUTTON();
        btnUpdate = new systemControlsComponent.JBUTTON();
        btnDelete = new systemControlsComponent.JBUTTON();
        btnClear = new systemControlsComponent.JBUTTON();
        btnAll = new systemControlsComponent.JBUTTON();
        btnFind = new systemControlsComponent.JBUTTON();
        btnBack = new systemControlsComponent.JBUTTON();
        jLabel7 = new javax.swing.JLabel();
        rdID = new javax.swing.JRadioButton();
        rdName = new javax.swing.JRadioButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblDraginfo = new javax.swing.JTable();
        btnSesrch = new systemControlsComponent.JBUTTON();
        txtID = new systemControlsComponent.JTEXTBOX(70);
        txtPrice = new systemControlsComponent.JTEXTBOX(70);
        txtName = new systemControlsComponent.JTEXTBOX(70);
        txtSearchKey = new systemControlsComponent.JTEXTBOX(70);
        btnAddStore = new systemControlsComponent.JBUTTON();
        txtdraQuantity = new systemControlsComponent.JTEXTBOX(70);
        jLabel8 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setBackground(new java.awt.Color(142, 180, 191));
        setMaximumSize(new java.awt.Dimension(1600, 900));
        setMinimumSize(new java.awt.Dimension(1600, 600));
        setResizable(false);
        setSize(new java.awt.Dimension(1600, 900));
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel2.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        jLabel2.setText("Name:");
        getContentPane().add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 120, -1, -1));

        jLabel3.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        jLabel3.setText("Drag ID:");
        getContentPane().add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 40, -1, -1));

        jLabel4.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        jLabel4.setText("Expiry Date:");
        getContentPane().add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 190, -1, -1));

        jLabel5.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        jLabel5.setText("Price:");
        getContentPane().add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 280, -1, -1));

        jLabel6.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        jLabel6.setText("Store Address:");
        getContentPane().add(jLabel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 420, -1, -1));
        getContentPane().add(calenderExDate, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 190, 170, -1));
        getContentPane().add(comStrCode, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 420, 172, 29));

        btnAdd.setText("Add");
        btnAdd.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAddActionPerformed(evt);
            }
        });
        getContentPane().add(btnAdd, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 480, 90, 40));

        btnUpdate.setText("Update");
        btnUpdate.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnUpdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUpdateActionPerformed(evt);
            }
        });
        getContentPane().add(btnUpdate, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 480, 100, 40));

        btnDelete.setText("Delete");
        btnDelete.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDeleteActionPerformed(evt);
            }
        });
        getContentPane().add(btnDelete, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 480, 110, 40));

        btnClear.setText("Clear");
        btnClear.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnClear.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnClearActionPerformed(evt);
            }
        });
        getContentPane().add(btnClear, new org.netbeans.lib.awtextra.AbsoluteConstraints(220, 550, 100, 40));

        btnAll.setText("All");
        btnAll.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnAll.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAllActionPerformed(evt);
            }
        });
        getContentPane().add(btnAll, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 550, 110, 40));

        btnFind.setText("Find");
        btnFind.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnFind.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnFindActionPerformed(evt);
            }
        });
        getContentPane().add(btnFind, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 550, 90, 40));

        btnBack.setText("Back");
        btnBack.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnBack.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnBackActionPerformed(evt);
            }
        });
        getContentPane().add(btnBack, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 630, 90, 40));

        jLabel7.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        jLabel7.setText("Search by:");
        getContentPane().add(jLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(670, 40, -1, -1));

        rdID.setBackground(new java.awt.Color(219, 240, 237));
        rdID.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        rdID.setSelected(true);
        rdID.setText("ID");
        getContentPane().add(rdID, new org.netbeans.lib.awtextra.AbsoluteConstraints(780, 40, -1, -1));

        rdName.setBackground(new java.awt.Color(219, 240, 237));
        rdName.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        rdName.setText("Name");
        getContentPane().add(rdName, new org.netbeans.lib.awtextra.AbsoluteConstraints(860, 40, -1, -1));

        tblDraginfo.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        tblDraginfo.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "ID", "Name", "Expiry Date", "Price", "Quntity", "Store Code", "Srore Address"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, true
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblDraginfo.setRowMargin(5);
        tblDraginfo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblDraginfoMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tblDraginfo);

        getContentPane().add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(670, 170, 740, 490));

        btnSesrch.setText("Search");
        btnSesrch.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnSesrch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSesrchActionPerformed(evt);
            }
        });
        getContentPane().add(btnSesrch, new org.netbeans.lib.awtextra.AbsoluteConstraints(910, 100, -1, -1));

        txtID.setEditable(false);
        txtID.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtID.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtIDActionPerformed(evt);
            }
        });
        getContentPane().add(txtID, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 40, 173, 29));

        txtPrice.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtPrice.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtPriceActionPerformed(evt);
            }
        });
        getContentPane().add(txtPrice, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 280, 173, 29));

        txtName.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtName.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtNameActionPerformed(evt);
            }
        });
        getContentPane().add(txtName, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 120, 173, 29));

        txtSearchKey.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        getContentPane().add(txtSearchKey, new org.netbeans.lib.awtextra.AbsoluteConstraints(670, 100, 190, 29));

        btnAddStore.setText("+");
        btnAddStore.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        btnAddStore.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAddStoreActionPerformed(evt);
            }
        });
        getContentPane().add(btnAddStore, new org.netbeans.lib.awtextra.AbsoluteConstraints(420, 420, -1, 29));

        txtdraQuantity.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        txtdraQuantity.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtdraQuantityActionPerformed(evt);
            }
        });
        getContentPane().add(txtdraQuantity, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 350, 172, 29));

        jLabel8.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N
        jLabel8.setText("Quantity:");
        getContentPane().add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 350, -1, -1));

        jLabel1.setIcon(new javax.swing.ImageIcon("D:\\courses\\Paharmacy project\\Design Phase\\Drags2.jpg")); // NOI18N
        getContentPane().add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 1600, 900));

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void btnDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDeleteActionPerformed
        setValues();
        dr.delete();
        dr.getAllRows(tblDraginfo);
        clearTxt();
    }//GEN-LAST:event_btnDeleteActionPerformed

    private void btnClearActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnClearActionPerformed
        clearTxt();
    }//GEN-LAST:event_btnClearActionPerformed

    private void btnAllActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAllActionPerformed
        db.go.fillToJtable("select *from drugdata", tblDraginfo);
    }//GEN-LAST:event_btnAllActionPerformed

    private void btnFindActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnFindActionPerformed
        int strF = Integer.parseInt(myprotools.inputBox("Enter ID").toString());
        db.go.fillToJtable("select *from drugdata where ID= " + strF, tblDraginfo);

    }//GEN-LAST:event_btnFindActionPerformed

    private void btnBackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnBackActionPerformed
        this.dispose();
        myprotools.setOpenForm(new frmMain(),"Main Form");
    }//GEN-LAST:event_btnBackActionPerformed

    private void btnSesrchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSesrchActionPerformed
        String statement = "select *from drugdata where ";
        if (rdID.isSelected()) {
            statement += "Id ";
        } else {
            statement += "Name ";
        }
        statement+="like'%"+txtSearchKey.getText()+"%'";
        db.go.fillToJtable(statement, tblDraginfo);
    }//GEN-LAST:event_btnSesrchActionPerformed

    private void txtPriceActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtPriceActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtPriceActionPerformed

    private void txtNameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtNameActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtNameActionPerformed
    Drags dr = new Drags();

    private void setValues() {
        dr.setDraID(Integer.parseInt(txtID.getText()));
        dr.setDraName(txtName.getText());
        SimpleDateFormat f = new SimpleDateFormat("yyyy-MM-dd");
        String ExDate = String.valueOf(f.format(calenderExDate.getDate()));
        dr.setDraExDate(ExDate);
        dr.setDraPrise(Double.parseDouble(txtPrice.getText()));
        dr.setDraQuantity(Integer.parseInt(txtdraQuantity.getText()));
        String strAddress = comStrCode.getSelectedItem().toString();
        String strCode = new Store().getValueByName(strAddress);
        dr.setStoreCode(Integer.parseInt(strCode));
    }

    private void clearTxt() {
        myprotools.cleartxt(this);
        btnAdd.setEnabled(true);
        btnUpdate.setEnabled(false);
        btnDelete.setEnabled(false);
        txtID.setText(dr.getAutoNumber());
    }
    private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened
        clearTxt();
        btnGroup.add(rdID);
        btnGroup.add(rdName);
        db.go.fillCompoBox("store", "storeAddress", comStrCode);
        db.go.fillToJtable("select *from drugdata", tblDraginfo);
        txtID.setText(db.go.autoNumber("drug", "drugId"));


    }//GEN-LAST:event_formWindowOpened

    private void btnAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddActionPerformed
        setValues();
        dr.add();
        db.go.fillToJtable("select *from drugdata", tblDraginfo);
        clearTxt();
        txtID.setText(dr.getAutoNumber());
    }//GEN-LAST:event_btnAddActionPerformed

    private void btnUpdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUpdateActionPerformed
        setValues();
        dr.update();
        db.go.fillToJtable("select *from drugdata", tblDraginfo);
        clearTxt();
    }//GEN-LAST:event_btnUpdateActionPerformed

    private void btnAddStoreActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddStoreActionPerformed
        this.dispose();
        myprotools.setOpenForm(new frmStore(),"Main Form/Store");
    }//GEN-LAST:event_btnAddStoreActionPerformed

    private void tblDraginfoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblDraginfoMouseClicked
        try {
            int row = tblDraginfo.getSelectedRow();
            String id = tblDraginfo.getValueAt(row, 0).toString();
            String name = tblDraginfo.getValueAt(row, 1).toString();
            String price = tblDraginfo.getValueAt(row, 3).toString();
            String quantity=tblDraginfo.getValueAt(row, 4).toString();
            
            SimpleDateFormat f = new SimpleDateFormat("yyyy-MM-dd");
            Date da = f.parse(tblDraginfo.getValueAt(row, 2).toString());
            txtID.setText(id);
            txtName.setText(name);
            calenderExDate.setDate(da);
            txtPrice.setText(price);
            txtdraQuantity.setText(quantity);
            int valu=Integer.parseInt(tblDraginfo.getValueAt(row, 5).toString());
            comStrCode.setSelectedIndex((valu-1));
            btnAdd.setEnabled(false);
            btnDelete.setEnabled(true);
            btnUpdate.setEnabled(true);
        }catch(Exception e){
            myprotools.msgbooks(e.getMessage());
        }

    }//GEN-LAST:event_tblDraginfoMouseClicked

    private void txtdraQuantityActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtdraQuantityActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtdraQuantityActionPerformed

    private void txtIDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtIDActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtIDActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(frmDrags.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(frmDrags.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(frmDrags.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(frmDrags.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new frmDrags().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private systemControlsComponent.JBUTTON btnAdd;
    private systemControlsComponent.JBUTTON btnAddStore;
    private systemControlsComponent.JBUTTON btnAll;
    private systemControlsComponent.JBUTTON btnBack;
    private systemControlsComponent.JBUTTON btnClear;
    private systemControlsComponent.JBUTTON btnDelete;
    private systemControlsComponent.JBUTTON btnFind;
    private javax.swing.ButtonGroup btnGroup;
    private systemControlsComponent.JBUTTON btnSesrch;
    private systemControlsComponent.JBUTTON btnUpdate;
    private com.toedter.calendar.JDateChooser calenderExDate;
    private systemControlsComponent.JCOMPBOX comStrCode;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JRadioButton rdID;
    private javax.swing.JRadioButton rdName;
    private javax.swing.JTable tblDraginfo;
    private javax.swing.JTextField txtID;
    private javax.swing.JTextField txtName;
    private javax.swing.JTextField txtPrice;
    private javax.swing.JTextField txtSearchKey;
    private javax.swing.JTextField txtdraQuantity;
    // End of variables declaration//GEN-END:variables
}
